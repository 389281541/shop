<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.rainbow.admin.mapper.SpecNameMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.rainbow.admin.entity.SpecName">
        <id column="id" property="id" />
        <result column="name" property="name" />
        <result column="item_id" property="itemId" />
        <result column="exist_alias" property="existAlias" />
        <result column="is_color" property="color" />
        <result column="is_enumeration" property="enumeration" />
        <result column="is_input" property="input" />
        <result column="is_key" property="key" />
        <result column="is_sku" property="sku" />
        <result column="is_search" property="search" />
        <result column="is_must" property="must" />
        <result column="is_multiple" property="multiple" />
        <result column="del_status" property="delStatus" />
        <result column="update_time" property="updateTime" />
        <result column="create_time" property="createTime" />
        <collection property="specValues" column="spec_name_id" ofType="com.rainbow.common.model.IdName">
            <id column="spec_name_id" property="id"/>
            <result column="spec_value" property="name"/>
        </collection>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, name, item_id, exist_alias, is_color, is_enumeration, is_input, is_key, is_sku, is_search, is_must, is_multiple, del_status, update_time, create_time
    </sql>

    <select id="pageSpecName" parameterType="com.rainbow.admin.api.dto.SpecNameSearchDTO" resultMap="BaseResultMap">
        select
            sn.*,
            sv.id as spec_name_id,
            sv.spec_value as spec_value
        from spec_name sn
        left join spec_value sv
            on sn.id = sv.spec_name_id
        where
            sn.del_status = 0
        <if test="param.id != null">
            and sn.item_id = #{param.id}
        </if>
        <if test="param.name != null">
            and sn.name like CONCAT('%',#{param.name},'%')
        </if>
        <if test="param.color != null">
            and sn.is_color = #{param.color}
        </if>
        <if test="param.enumeration != null">
            and sn.is_enumeration = #{param.enumeration}
        </if>
        <if test="param.input != null">
            and sn.is_input = #{param.input}
        </if>
        <if test="param.key != null">
            and sn.is_key = #{param.key}
        </if>
        <if test="param.sku != null">
            and sn.is_sku = #{param.sku}
        </if>
        <if test="param.search != null">
            and sn.is_search = #{param.search}
        </if>
        <if test="param.multiple != null">
            and sn.is_multiple = #{param.multiple}
        </if>
    </select>

</mapper>
